%%!PS-Adobe-3.0 EPSF-3.0
%%%%Creator: COBRAlab
%%%%CreationDate: 
%%%%Title: Dot.ps
%%%%BoundingBox: 66 211 518 662
%%%%DocumentFonts: Helvetica
%%%%Pages: 1
%%%%EndComments

/DPdict 100 dict def

DPdict begin

%%%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  % draw strand separators if required
  currentdict /nicks known {
    gsave
    % draw lines in red color
    0 1 1 sethsbcolor
    % draw with line thickness of 0.2
    0.2 setlinewidth
    nicks
    { 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
    } forall
    grestore
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup 3 -1 roll dup 4 1 roll lt
  {
    0 len len len len 0 8 -2 roll exch 1 sub dup dup len exch sub 3 -1 roll 4 -1 roll dup len exch sub dup 3 1 roll
    moveto lineto lineto lineto lineto lineto
  }
  {
    exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
    moveto lineto lineto
  } ifelse
  closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def

/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%%%EndProlog

/DPtitle {
  (%s)
} def

/sequence { (\
CGAGGGGCGGUUGGCCUCGUAAAAAGCCGCAAAAAAUAGUCGCAAACGACGAAAACUACGCUUUAGCAGCUUAAUAACCUGCUUAGAGCCCUCUCUCCCUAGCCUCCGCUCUUAGGAUGGGGAUCAAGAGAGGUCAAACCCAAAAGAGAUCGCGUGGAAGCCCUGCCUGGGGUUGAAGCGUUAAAACUUAAUCAGGCUAGUUUGUUAGUGGCGUGUCCGUCCGCAGCUGGCAAGCGAAUGUAAAGACUGACUAA
) } def
/len { sequence length } bind def

72 216 translate
72 6 mul len 1 add div dup scale
/Helvetica findfont 0.95 scalefont setfont

drawseq
%%data starts here

/hsb {
sethsbcolor
} bind def

%%draw the grid
drawgrid

%%start of base pair probability data
0 .7 .75 hsb 1 19 0.785493 ubox
0 .7 .75 hsb 1 219 0.391152 ubox
0 .7 .75 hsb 2 18 0.78867 ubox
0 .7 .75 hsb 2 218 0.333167 ubox
0 .7 .75 hsb 3 17 0.780385 ubox
0 .7 .75 hsb 4 16 0.773305 ubox
0 .7 .75 hsb 4 141 0.466905 ubox
0 .7 .75 hsb 5 15 0.751665 ubox
0 .7 .75 hsb 5 140 0.477493 ubox
0 .7 .75 hsb 6 139 0.470106 ubox
.7 1 0 hsb 7 30 1 ubox
.7 1 0 hsb 8 29 1 ubox
.7 1 0 hsb 9 28 1 ubox
.7 1 0 hsb 10 27 1 ubox
.7 1 0 hsb 11 26 1 ubox
.7 1 0 hsb 12 25 1 ubox
0 .7 .75 hsb 37 199 0.3937 ubox
0 .7 .75 hsb 38 198 0.43589 ubox
0 .7 .75 hsb 39 50 0.74162 ubox
0 .7 .75 hsb 39 197 0.428952 ubox
0 .7 .75 hsb 40 49 0.752994 ubox
0 .7 .75 hsb 40 196 0.413521 ubox
0 .7 .75 hsb 41 48 0.756968 ubox
0 .7 .75 hsb 41 195 0.406202 ubox
0 .7 .75 hsb 42 47 0.748331 ubox
0 .7 .75 hsb 42 50 0.330151 ubox
0 .7 .75 hsb 60 89 0.975192 ubox
0 .7 .75 hsb 61 88 0.989444 ubox
.7 1 0 hsb 62 87 1 ubox
.7 1 0 hsb 63 86 1 ubox
.7 1 0 hsb 64 85 1 ubox
.7 1 0 hsb 65 84 1 ubox
.7 1 0 hsb 66 82 1 ubox
.7 1 0 hsb 67 81 1 ubox
.7 1 0 hsb 68 80 1 ubox
.7 1 0 hsb 69 79 1 ubox
0 .7 .75 hsb 71 77 0.419524 ubox
0 .7 .75 hsb 72 76 0.363318 ubox
.7 1 0 hsb 90 133 1 ubox
.7 1 0 hsb 91 132 1 ubox
.7 1 0 hsb 92 131 1 ubox
.7 1 0 hsb 93 130 1 ubox
.7 1 0 hsb 94 129 1 ubox
.7 1 0 hsb 95 128 1 ubox
0 .7 .75 hsb 96 123 0.593296 ubox
0 .7 .75 hsb 96 127 0.592453 ubox
.7 1 0 hsb 97 122 1 ubox
.7 1 0 hsb 98 121 1 ubox
.7 1 0 hsb 99 120 1 ubox
.7 1 0 hsb 100 119 1 ubox
0 .7 .75 hsb 101 118 0.898888 ubox
.7 1 0 hsb 103 116 1 ubox
.7 1 0 hsb 104 115 1 ubox
.7 1 0 hsb 105 114 1 ubox
0 .7 .75 hsb 144 189 0.564801 ubox
0 .7 .75 hsb 145 188 0.648845 ubox
0 .7 .75 hsb 146 187 0.675278 ubox
0 .7 .75 hsb 146 189 0.32249 ubox
0 .7 .75 hsb 147 188 0.353553 ubox
0 .7 .75 hsb 148 187 0.384708 ubox
.7 1 0 hsb 152 181 1 ubox
.7 1 0 hsb 153 180 1 ubox
.7 1 0 hsb 154 179 1 ubox
.7 1 0 hsb 155 178 1 ubox
.7 1 0 hsb 159 174 1 ubox
.7 1 0 hsb 160 173 1 ubox
.7 1 0 hsb 161 172 1 ubox
.7 1 0 hsb 162 171 1 ubox
.7 1 0 hsb 163 170 1 ubox
0 .7 .75 hsb 164 169 0.710634 ubox
0 .7 .75 hsb 165 197 0.324037 ubox
0 .7 .75 hsb 166 196 0.336155 ubox
0 .7 .75 hsb 167 195 0.339116 ubox
0 .7 .75 hsb 168 194 0.337639 ubox
0 .7 .75 hsb 169 193 0.32249 ubox
0 .7 .75 hsb 192 250 0.438178 ubox
0 .7 .75 hsb 193 249 0.462601 ubox
0 .7 .75 hsb 194 248 0.45607 ubox
0 .7 .75 hsb 195 247 0.457165 ubox
0 .7 .75 hsb 196 241 0.343511 ubox
0 .7 .75 hsb 197 240 0.387298 ubox
.7 1 0 hsb 200 235 1 ubox
.7 1 0 hsb 201 234 1 ubox
.7 1 0 hsb 202 233 1 ubox
.7 1 0 hsb 203 232 1 ubox
.7 1 0 hsb 204 231 1 ubox
.7 1 0 hsb 205 230 1 ubox
.7 1 0 hsb 206 229 1 ubox
.7 1 0 hsb 207 228 1 ubox
.7 1 0 hsb 208 227 1 ubox
0 .7 .75 hsb 209 226 0.74027 ubox
.7 1 0 hsb 211 224 1 ubox
.7 1 0 hsb 212 223 1 ubox
.7 1 0 hsb 213 222 1 ubox
0 .7 .75 hsb 215 221 0.333167 ubox
.7 1 0 hsb 213 222 1 lbox
.7 1 0 hsb 212 223 1 lbox
.7 1 0 hsb 211 224 1 lbox
0 .7 .75 hsb 209 226 1 lbox
.7 1 0 hsb 208 227 1 lbox
.7 1 0 hsb 207 228 1 lbox
.7 1 0 hsb 206 229 1 lbox
.7 1 0 hsb 205 230 1 lbox
.7 1 0 hsb 204 231 1 lbox
.7 1 0 hsb 203 232 1 lbox
.7 1 0 hsb 202 233 1 lbox
.7 1 0 hsb 201 234 1 lbox
.7 1 0 hsb 200 235 1 lbox
0 .7 .75 hsb 169 193 1 lbox
0 .7 .75 hsb 168 194 1 lbox
0 .7 .75 hsb 167 195 1 lbox
0 .7 .75 hsb 166 196 1 lbox
0 .7 .75 hsb 165 197 1 lbox
.7 1 0 hsb 163 170 1 lbox
.7 1 0 hsb 162 171 1 lbox
.7 1 0 hsb 161 172 1 lbox
.7 1 0 hsb 160 173 1 lbox
.7 1 0 hsb 159 174 1 lbox
.7 1 0 hsb 155 178 1 lbox
.7 1 0 hsb 154 179 1 lbox
.7 1 0 hsb 153 180 1 lbox
.7 1 0 hsb 152 181 1 lbox
0 .7 .75 hsb 113 144 1 lbox
0 .7 .75 hsb 112 145 1 lbox
0 .7 .75 hsb 111 146 1 lbox
0 .7 .75 hsb 110 147 1 lbox
0 .7 .75 hsb 109 148 1 lbox
.7 1 0 hsb 105 114 1 lbox
.7 1 0 hsb 104 115 1 lbox
.7 1 0 hsb 103 116 1 lbox
.7 1 0 hsb 100 119 1 lbox
.7 1 0 hsb 99 120 1 lbox
.7 1 0 hsb 98 121 1 lbox
.7 1 0 hsb 97 122 1 lbox
.7 1 0 hsb 95 128 1 lbox
.7 1 0 hsb 94 129 1 lbox
.7 1 0 hsb 93 130 1 lbox
.7 1 0 hsb 92 131 1 lbox
.7 1 0 hsb 91 132 1 lbox
.7 1 0 hsb 90 133 1 lbox
.7 1 0 hsb 69 79 1 lbox
.7 1 0 hsb 68 80 1 lbox
.7 1 0 hsb 67 81 1 lbox
.7 1 0 hsb 66 82 1 lbox
.7 1 0 hsb 65 84 1 lbox
.7 1 0 hsb 64 85 1 lbox
.7 1 0 hsb 63 86 1 lbox
.7 1 0 hsb 62 87 1 lbox
0 .7 .75 hsb 61 88 1 lbox
0 .7 .75 hsb 60 89 1 lbox
0 .7 .75 hsb 42 47 1 lbox
0 .7 .75 hsb 41 48 1 lbox
0 .7 .75 hsb 40 49 1 lbox
0 .7 .75 hsb 39 50 1 lbox
.7 1 0 hsb 12 25 1 lbox
.7 1 0 hsb 11 26 1 lbox
.7 1 0 hsb 10 27 1 lbox
.7 1 0 hsb 9 28 1 lbox
.7 1 0 hsb 8 29 1 lbox
.7 1 0 hsb 7 30 1 lbox
0 .7 .75 hsb 5 15 1 lbox
0 .7 .75 hsb 4 16 1 lbox
0 .7 .75 hsb 3 17 1 lbox
0 .7 .75 hsb 2 18 1 lbox
0 .7 .75 hsb 1 19 1 lbox
showpage
end
%%%%EOF
