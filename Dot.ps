%%!PS-Adobe-3.0 EPSF-3.0
%%%%Creator: COBRAlab
%%%%CreationDate: 
%%%%Title: Dot.ps
%%%%BoundingBox: 66 211 518 662
%%%%DocumentFonts: Helvetica
%%%%Pages: 1
%%%%EndComments

/DPdict 100 dict def

DPdict begin

%%%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  % draw strand separators if required
  currentdict /nicks known {
    gsave
    % draw lines in red color
    0 1 1 sethsbcolor
    % draw with line thickness of 0.2
    0.2 setlinewidth
    nicks
    { 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
    } forall
    grestore
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup 3 -1 roll dup 4 1 roll lt
  {
    0 len len len len 0 8 -2 roll exch 1 sub dup dup len exch sub 3 -1 roll 4 -1 roll dup len exch sub dup 3 1 roll
    moveto lineto lineto lineto lineto lineto
  }
  {
    exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
    moveto lineto lineto
  } ifelse
  closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def

/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%%%EndProlog

/DPtitle {
  (%s)
} def

/sequence { (\
GGGGCUGAUUCUGGAUUCGACGGGAUUUGCGAAACCCAAGGUGCAUGCCGAGGGGCGGUUGGCCUCGUAAAAAGCCGCAAAAAAUAGUCGCAAACGACGAAAACUACGCUUUAGCAGCUUAAUAACCUGCUUAGAGCCCUCUCUCCCUAGCCUCCGCUCUUAGGAUGGGGAUCAAGAGAGGUCAAACCCAAAAGAGAUCGCGUGGAAGCCCUGCCUGGGGUUGAAGCGUUAAAACUUAAUCAGGCUAGUUUGUUAGUGGCGUGUCCGUCCGCAGCUGGCAAGCGAAUGUAAAGACUGACUAAGCAUGUAGUACCGAGGAUGUAGGAAUUUCGGACGCGGGUUCAACUCCCGCCAGCUCCACCA
) } def
/len { sequence length } bind def

72 216 translate
72 6 mul len 1 add div dup scale
/Helvetica findfont 0.95 scalefont setfont

drawseq
%%data starts here

/hsb {
sethsbcolor
} bind def

%%draw the grid
drawgrid

%%start of base pair probability data
.7 1 0 hsb 1 359 1 ubox
.7 1 0 hsb 2 358 1 ubox
.7 1 0 hsb 3 357 1 ubox
.7 1 0 hsb 4 356 1 ubox
.7 1 0 hsb 5 355 1 ubox
.7 1 0 hsb 6 354 1 ubox
.7 1 0 hsb 7 353 1 ubox
0 .7 .75 hsb 17 334 0.362215 ubox
0 .7 .75 hsb 18 333 0.378021 ubox
.7 1 0 hsb 21 332 1 ubox
.7 1 0 hsb 22 331 1 ubox
.7 1 0 hsb 23 330 1 ubox
.7 1 0 hsb 24 329 1 ubox
.7 1 0 hsb 25 328 1 ubox
.7 1 0 hsb 26 327 1 ubox
.7 1 0 hsb 27 326 1 ubox
.7 1 0 hsb 28 325 1 ubox
0 .7 .75 hsb 30 324 0.775435 ubox
.7 1 0 hsb 34 320 1 ubox
.7 1 0 hsb 36 318 1 ubox
.7 1 0 hsb 37 317 1 ubox
.7 1 0 hsb 40 314 1 ubox
.7 1 0 hsb 41 313 1 ubox
.7 1 0 hsb 42 312 1 ubox
0 .7 .75 hsb 43 308 0.877724 ubox
0 .7 .75 hsb 43 311 0.412795 ubox
.7 1 0 hsb 44 307 1 ubox
.7 1 0 hsb 45 306 1 ubox
.7 1 0 hsb 46 305 1 ubox
.7 1 0 hsb 47 304 1 ubox
.7 1 0 hsb 48 303 1 ubox
0 .7 .75 hsb 52 189 0.871894 ubox
0 .7 .75 hsb 53 188 0.881306 ubox
0 .7 .75 hsb 54 187 0.867122 ubox
.7 1 0 hsb 55 78 1 ubox
.7 1 0 hsb 56 77 1 ubox
.7 1 0 hsb 57 76 1 ubox
.7 1 0 hsb 58 75 1 ubox
.7 1 0 hsb 59 74 1 ubox
.7 1 0 hsb 60 73 1 ubox
0 .7 .75 hsb 87 98 0.90945 ubox
0 .7 .75 hsb 88 97 0.91351 ubox
0 .7 .75 hsb 89 96 0.918205 ubox
0 .7 .75 hsb 90 95 0.898944 ubox
0 .7 .75 hsb 99 183 0.323728 ubox
0 .7 .75 hsb 108 137 0.979183 ubox
0 .7 .75 hsb 109 136 0.993479 ubox
.7 1 0 hsb 110 135 1 ubox
.7 1 0 hsb 111 134 1 ubox
.7 1 0 hsb 112 133 1 ubox
.7 1 0 hsb 113 132 1 ubox
.7 1 0 hsb 114 130 1 ubox
.7 1 0 hsb 115 129 1 ubox
.7 1 0 hsb 116 128 1 ubox
.7 1 0 hsb 117 127 1 ubox
0 .7 .75 hsb 119 125 0.4219 ubox
0 .7 .75 hsb 120 124 0.338526 ubox
.7 1 0 hsb 138 181 1 ubox
.7 1 0 hsb 139 180 1 ubox
.7 1 0 hsb 140 179 1 ubox
.7 1 0 hsb 141 178 1 ubox
.7 1 0 hsb 142 177 1 ubox
.7 1 0 hsb 143 176 1 ubox
0 .7 .75 hsb 144 171 0.576021 ubox
0 .7 .75 hsb 144 175 0.64846 ubox
.7 1 0 hsb 145 170 1 ubox
.7 1 0 hsb 146 169 1 ubox
.7 1 0 hsb 147 168 1 ubox
.7 1 0 hsb 148 167 1 ubox
0 .7 .75 hsb 149 166 0.947787 ubox
.7 1 0 hsb 151 164 1 ubox
.7 1 0 hsb 152 163 1 ubox
.7 1 0 hsb 153 162 1 ubox
0 .7 .75 hsb 192 237 0.592706 ubox
0 .7 .75 hsb 193 236 0.70647 ubox
0 .7 .75 hsb 194 235 0.764068 ubox
0 .7 .75 hsb 195 236 0.341614 ubox
0 .7 .75 hsb 196 235 0.384578 ubox
0 .7 .75 hsb 198 231 0.331059 ubox
0 .7 .75 hsb 200 229 0.89627 ubox
.7 1 0 hsb 201 228 1 ubox
.7 1 0 hsb 202 227 1 ubox
.7 1 0 hsb 203 226 1 ubox
0 .7 .75 hsb 207 222 0.895768 ubox
0 .7 .75 hsb 208 221 0.974885 ubox
0 .7 .75 hsb 209 220 0.997146 ubox
0 .7 .75 hsb 210 219 0.995791 ubox
0 .7 .75 hsb 211 218 0.98519 ubox
0 .7 .75 hsb 212 217 0.781601 ubox
0 .7 .75 hsb 237 301 0.349285 ubox
0 .7 .75 hsb 238 300 0.347707 ubox
0 .7 .75 hsb 240 298 0.795236 ubox
0 .7 .75 hsb 241 297 0.842556 ubox
0 .7 .75 hsb 242 296 0.840892 ubox
0 .7 .75 hsb 243 295 0.833727 ubox
0 .7 .75 hsb 244 289 0.595315 ubox
0 .7 .75 hsb 245 288 0.652074 ubox
0 .7 .75 hsb 245 293 0.468615 ubox
0 .7 .75 hsb 246 292 0.345688 ubox
.7 1 0 hsb 248 283 1 ubox
.7 1 0 hsb 249 282 1 ubox
.7 1 0 hsb 250 281 1 ubox
.7 1 0 hsb 251 280 1 ubox
.7 1 0 hsb 252 279 1 ubox
.7 1 0 hsb 253 278 1 ubox
.7 1 0 hsb 254 277 1 ubox
.7 1 0 hsb 255 276 1 ubox
.7 1 0 hsb 256 275 1 ubox
0 .7 .75 hsb 257 274 0.983056 ubox
.7 1 0 hsb 259 272 1 ubox
.7 1 0 hsb 260 271 1 ubox
.7 1 0 hsb 261 270 1 ubox
0 .7 .75 hsb 263 269 0.473814 ubox
0 .7 .75 hsb 287 292 0.346843 ubox
.7 1 0 hsb 336 352 1 ubox
.7 1 0 hsb 337 351 1 ubox
.7 1 0 hsb 338 350 1 ubox
.7 1 0 hsb 339 349 1 ubox
.7 1 0 hsb 340 348 1 ubox
.7 1 0 hsb 340 348 1 lbox
.7 1 0 hsb 339 349 1 lbox
.7 1 0 hsb 338 350 1 lbox
.7 1 0 hsb 337 351 1 lbox
.7 1 0 hsb 336 352 1 lbox
.7 1 0 hsb 261 270 1 lbox
.7 1 0 hsb 260 271 1 lbox
.7 1 0 hsb 259 272 1 lbox
0 .7 .75 hsb 257 274 1 lbox
.7 1 0 hsb 256 275 1 lbox
.7 1 0 hsb 255 276 1 lbox
.7 1 0 hsb 254 277 1 lbox
.7 1 0 hsb 253 278 1 lbox
.7 1 0 hsb 252 279 1 lbox
.7 1 0 hsb 251 280 1 lbox
.7 1 0 hsb 250 281 1 lbox
.7 1 0 hsb 249 282 1 lbox
.7 1 0 hsb 248 283 1 lbox
0 .7 .75 hsb 245 288 1 lbox
0 .7 .75 hsb 244 289 1 lbox
0 .7 .75 hsb 243 295 1 lbox
0 .7 .75 hsb 242 296 1 lbox
0 .7 .75 hsb 241 297 1 lbox
0 .7 .75 hsb 240 298 1 lbox
0 .7 .75 hsb 212 217 1 lbox
0 .7 .75 hsb 211 218 1 lbox
0 .7 .75 hsb 210 219 1 lbox
0 .7 .75 hsb 209 220 1 lbox
0 .7 .75 hsb 208 221 1 lbox
0 .7 .75 hsb 207 222 1 lbox
.7 1 0 hsb 203 226 1 lbox
.7 1 0 hsb 202 227 1 lbox
.7 1 0 hsb 201 228 1 lbox
0 .7 .75 hsb 200 229 1 lbox
0 .7 .75 hsb 194 235 1 lbox
0 .7 .75 hsb 193 236 1 lbox
0 .7 .75 hsb 192 237 1 lbox
.7 1 0 hsb 153 162 1 lbox
.7 1 0 hsb 152 163 1 lbox
.7 1 0 hsb 151 164 1 lbox
0 .7 .75 hsb 149 166 1 lbox
.7 1 0 hsb 148 167 1 lbox
.7 1 0 hsb 147 168 1 lbox
.7 1 0 hsb 146 169 1 lbox
.7 1 0 hsb 145 170 1 lbox
0 .7 .75 hsb 144 175 1 lbox
.7 1 0 hsb 143 176 1 lbox
.7 1 0 hsb 142 177 1 lbox
.7 1 0 hsb 141 178 1 lbox
.7 1 0 hsb 140 179 1 lbox
.7 1 0 hsb 139 180 1 lbox
.7 1 0 hsb 138 181 1 lbox
.7 1 0 hsb 117 127 1 lbox
.7 1 0 hsb 116 128 1 lbox
.7 1 0 hsb 115 129 1 lbox
.7 1 0 hsb 114 130 1 lbox
.7 1 0 hsb 113 132 1 lbox
.7 1 0 hsb 112 133 1 lbox
.7 1 0 hsb 111 134 1 lbox
.7 1 0 hsb 110 135 1 lbox
0 .7 .75 hsb 109 136 1 lbox
0 .7 .75 hsb 108 137 1 lbox
0 .7 .75 hsb 90 95 1 lbox
0 .7 .75 hsb 89 96 1 lbox
0 .7 .75 hsb 88 97 1 lbox
0 .7 .75 hsb 87 98 1 lbox
.7 1 0 hsb 60 73 1 lbox
.7 1 0 hsb 59 74 1 lbox
.7 1 0 hsb 58 75 1 lbox
.7 1 0 hsb 57 76 1 lbox
.7 1 0 hsb 56 77 1 lbox
.7 1 0 hsb 55 78 1 lbox
0 .7 .75 hsb 54 187 1 lbox
0 .7 .75 hsb 53 188 1 lbox
0 .7 .75 hsb 52 189 1 lbox
.7 1 0 hsb 48 303 1 lbox
.7 1 0 hsb 47 304 1 lbox
.7 1 0 hsb 46 305 1 lbox
.7 1 0 hsb 45 306 1 lbox
.7 1 0 hsb 44 307 1 lbox
0 .7 .75 hsb 43 308 1 lbox
.7 1 0 hsb 42 312 1 lbox
.7 1 0 hsb 41 313 1 lbox
.7 1 0 hsb 40 314 1 lbox
.7 1 0 hsb 37 317 1 lbox
.7 1 0 hsb 36 318 1 lbox
.7 1 0 hsb 34 320 1 lbox
0 .7 .75 hsb 30 324 1 lbox
.7 1 0 hsb 28 325 1 lbox
.7 1 0 hsb 27 326 1 lbox
.7 1 0 hsb 26 327 1 lbox
.7 1 0 hsb 25 328 1 lbox
.7 1 0 hsb 24 329 1 lbox
.7 1 0 hsb 23 330 1 lbox
.7 1 0 hsb 22 331 1 lbox
.7 1 0 hsb 21 332 1 lbox
.7 1 0 hsb 7 353 1 lbox
.7 1 0 hsb 6 354 1 lbox
.7 1 0 hsb 5 355 1 lbox
.7 1 0 hsb 4 356 1 lbox
.7 1 0 hsb 3 357 1 lbox
.7 1 0 hsb 2 358 1 lbox
.7 1 0 hsb 1 359 1 lbox
showpage
end
%%%%EOF
